<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-date-picker/paper-date-picker.html">

<dom-module id="teacher-datepicker">
    <template>
        <style>
            :host {
                display: block;
            }
            p {
                color: var(--primary-text-color);
            }
            paper-date-picker{
                @apply(--layout-self-center);
            }
            #pdpw {
                @apply(--layout-vertical);
            }
        </style>

        <div id="pdpw">
            <paper-date-picker id="datepicker" date="{{selectedDate}}" min-date="{{minDate}}" max-date="{{maxDate}}"></paper-date-picker>
        </div>

    </template>

    <script>
        Polymer({
            is: 'teacher-datepicker',

            properties: {
                today: {
                    type: Date,
                    value: function () {
                        return new Date().setHours(0, 0, 0, 0);
                    }
                },
                minDate: {
                    type: Date,
                    value: function () {
                        var d = new Date();
                        return new Date(
                            d.getFullYear(), d.getMonth()
                        );
                    }
                },
                maxDate: {
                    type: Date,
                    value: function () {
                        console.log(new Date(new Date().setHours(23, 59, 59, 999) + 1000 * 3600 * 24 * 7));
                        return new Date(new Date().setHours(23, 59, 59, 999) + 1000 * 3600 * 24 * 7);
                    }
                },
                selectedDate: {
                    type: Date,
                    observer: '_validateDate'
                }
            },

            listeners: {},

            ready: function () {
                this.fire('pageLoad', this.nodeName);
            },

            _validateDate: function () {
                /**
                 * Function to validate the selected Date,
                 * Because paper-datatable is currently broken when using min-date & max-date and they both
                 * are in the same month - see comment to the specific GitHub-Issue:
                 *
                 * https://github.com/bendavis78/paper-date-picker/issues/170#issuecomment-277317879
                 **/
                if (this.selectedDate < this.today || this.selectedDate > this.maxDate) {
                    this.$.datepicker.date = new Date(this.today);
                }
            }
        });
    </script>
</dom-module>